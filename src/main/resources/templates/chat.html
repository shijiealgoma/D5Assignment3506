<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<script src="http://libs.baidu.com/jquery/2.1.4/jquery.min.js"></script>

<head th:replace="fragments :: head"></head>

<body>
    <!-- chat page html -->
    <div class="chatPage">
        <div class="container-fluid">
            <div class="row content">
                <!-- left side -->
                <div class="col-md-2 bgColor">
                    <div class="" th:replace="menuleft :: menuleft"></div>
                </div>
                <!-- chat list -->
                <div class="col-md-3 ">
                    <div class="userlist">
                        <!-- search user -->
                        <div class=" ">
                            <div class="input-group mb-3">
                                <input type="text" class="form-control" placeholder="Search Name…"
                                    aria-label="Search Name…" aria-describedby="button-addon2">
                            </div>

                        </div>
                        <!-- user list -->
                        <div class="userRow" th:each="user: ${allUsers}"  th:id = "${user.id}">
                            <img  th:src="${user.image}" alt="" class="profileImg" >
                            <div class="userInfo" >
                                <div class="">
                                    <a th:action="@{/userDetail2}" th:object="${user.username}"
                                        th:onclick="clickUser([[${user.id}]], [[${senderID}]])" method="post">
                                        <span class="userName" th:text="${user.firstName}">
                                            First Name
                                        </span>
                                        <span class="userName" th:text="${user.lastName}">
                                            Last Name
                                        </span>
                                    </a>
                                    <div class="msg" th:text="${user.username}">
                                        Hi, how are you?
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- login form -->
                <div class="col-md-7 centerContent chatMain">
                    <div class="chatMessages">
                        <!-- <div class="msgRow" th:each="user: ${allMessages}">
                            <img src="https://static.thenounproject.com/png/2416938-200.png" alt="" class="profileImg">
                            <div class="msgLeft">
                                <div class="msgUpper">
                                    <div class="userName">
                                        Aidan
                                    </div>
                                    <div class="time">
                                        12:00
                                    </div>
                                </div>
                                <div class="msgFull">
                                    <div class="msg" th:text="${message.content}">

                                    </div>
                                </div>



                            </div>
                            <div class="msgSpacer"></div>
                        </div> -->
                        <div class="msgRow">
                            <img src="https://static.thenounproject.com/png/2416938-200.png" alt="" class="profileImg">
                            <div class="msgLeft">
                                <div class="msgUpper">
                                    <div class="userName">
                                        Aidan
                                    </div>
                                    <div class="time">
                                        12:00
                                    </div>
                                </div>
                                <div class="msgFull">
                                    <div class="msg">
                                        Hi, how are you?
                                    </div>
                                </div>



                            </div>
                            <div class="msgSpacer"></div>
                        </div>
                        <div class="msgRow">
                            <div class="msgSpacer"></div>
                            <div class="msgRight">

                                <div class="msgUpper">
                                    <div class="userName">
                                        Aidan
                                    </div>
                                    <div class="time">
                                        12:00
                                    </div>


                                </div>
                                <div class="msgFull">
                                    <div class="msg">
                                        Hi, how are you?
                                    </div>
                                </div>

                            </div>
                            <img src="https://static.thenounproject.com/png/2416938-200.png" alt="" class="profileImg">
                        </div>
                        <div class="msgRow">
                            <div class="msgSpacer"></div>
                            <div class="msgRight">

                                <div class="msgUpper">
                                    <div class="userName">
                                        Aidan
                                    </div>
                                    <div class="time">
                                        12:00
                                    </div>


                                </div>
                                <div class="msgFull">
                                    <div class="msg">
                                        Hi, how are you? how are you? how are you? how are you? how are you? how are
                                        you? how are you? how are you? how are you? how are you? how are you? how are
                                        you? how are you? how are you? how are you? how are you?
                                    </div>
                                </div>

                            </div>
                            <img src="https://static.thenounproject.com/png/2416938-200.png" alt="" class="profileImg">
                        </div>

                    </div>
                    <form action="/sendMsg" method="post" id="message-form">
                        <div class="sendMessage">

                            <div class="sendMessageContent">
                                <input type="text" class="form-control inputMessage" id="content" name="content"
                                    placeholder="Type your message here...">
                            </div>
                            <div class="sendMessageButton">
                                <button type="submit" class="btn btn-primary">Send</button>
                            </div>



                        </div>
                    </form>
                    <script type="text/javascript">

                        var receiverID = "";
                        var senderID = "";

                        function clickUser(receiver_id, sender_id) {
                            
                            receiverID = receiver_id;
                            senderID = sender_id;
                            console.log("receiverID: " + receiverID);
                            console.log("senderID: " + senderID);
                        }




                        const form = document.querySelector('#message-form');
                        form.addEventListener('submit', (event) => {
                            event.preventDefault();



                            var msg = document.getElementById("content").value;
                            console.log("msg: " + msg);
                            $.ajax({
                                url: '/add',
                                type: 'POST',
                                data: {
                                    content: msg,
                                },
                                success: function (data) {
                                    console.log("success");
                                    //console.log(data);
                                },
                                error: function (data) {
                                    console.log("error");
                                    console.log(data);
                                }
                            });
                        });
                    </script>
                </div>
            </div>
        </div>
    </div>

    <!-- <div th:replace="fragments :: footer"></div> -->
    <div class="msgSpacer"></div>
</body>

</html>